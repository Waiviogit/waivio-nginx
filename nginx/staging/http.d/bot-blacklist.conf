##
## bot-blacklist.conf
##
## server {
##     ...
##     if ($block_bot) {
##         return 403;
##     }
##
##     # Optionally also block empty UA:
##     # if ($block_empty_ua) { return 403; }
##     ...
## }
##

#############################
# Block bad bots by User-Agent
#############################

# Map User-Agent → 1 if it's a bad bot, else 0
map $http_user_agent $block_bot {

    # ---------------------------
    # DEFAULT: allow everything
    # ---------------------------
    default 0;

    # ------------------------------------
    # WHITELIST – legit search engines
    # (must come BEFORE generic "bot" rules)
    # ------------------------------------
    "~*Googlebot"                   0;
    "~*Google-InspectionTool"      0;
    "~*AdsBot-Google"              0;
    "~*Mediapartners-Google"       0;  # AdSense
    "~*APIs-Google"                0;
    "~*FeedFetcher-Google"         0;

    "~*Bingbot"                    0;
    "~*DuckDuckBot"                0;
    "~*Applebot"                   0;

    "~*Yahoo! Slurp"               0;
    "~*facebot"                    0;  # FB crawler (if you want previews)
    "~*ia_archiver"                0;  # Alexa / Archive.org

    # Uptime / monitoring (whitelist if you use them)
    "~*UptimeRobot"                0;
    "~*Pingdom"                    0;
    "~*NewRelicPinger"             0;
    "~*StatusCake"                 0;
    "~*SiteUptime"                 0;

    # ------------------------------------
    # SEO crawlers / link intelligence
    # ------------------------------------
    "~*AhrefsBot"                  1;
    "~*AhrefsSiteAudit"            1;
    "~*SemrushBot"                 1;
    "~*MJ12bot"                    1;
    "~*DotBot"                     1;  # Moz
    "~*BLEXBot"                    1;
    "~*SEOkicks"                   1;
    "~*MojeekBot"                  1;
    "~*LinkpadBot"                 1;
    "~*SiteExplorer"               1;
    "~*MegaIndex"                  1;
    "~*DataForSeoBot"              1;
    "~*SerendeputyBot"             1;
    "~*Cocolyzebot"                1;

    # ------------------------------------
    # Non-Western big crawlers
    # (block if you don’t target these regions)
    # ------------------------------------
    "~*Baiduspider"                1;
    "~*Baiduspider-image"          1;
    "~*Baiduspider-video"          1;
    "~*Sogou web spider"           1;
    "~*Sogou head spider"          1;
    "~*Sosospider"                 1;
    "~*YisouSpider"                1;

    "~*YandexBot"                  1;
    "~*YandexMobileBot"            1;
    "~*YandexImages"               1;
    "~*YandexAccessibilityBot"     1;
    "~*YandexMetrika"              1;

    "~*Mail.RU_Bot"                1;
    "~*MailRuBot"                  1;

    # ------------------------------------
    # Site copiers / generic downloaders
    # ------------------------------------
    "~*HTTrack"                    1;
    "~*HTTrack Website Copier"     1;
    "~*WebCopier"                  1;
    "~*Teleport Pro"               1;
    "~*Wget"                       1;
    "~*wget"                       1;
    "~*curl"                       1;
    "~*libcurl"                    1;
    "~*FetchURL"                   1;

    # ------------------------------------
    # Generic HTTP libraries / scrapers
    # ------------------------------------
    "~*python-requests"            1;
    "~*Python-urllib"              1;
    "~*Python/"                    1;
    "~*Go-http-client"             1;
#    "~*httpclient"                 1;
    "~*Java/"                      1;
    "~*Jakarta Commons-HttpClient" 1;
    "~*libwww-perl"                1;
    "~*OkHttp"                     1;
#    "~*axios"                      1;
    "~*RestSharp"                  1;
    "~*WinHttp"                    1;

    # ------------------------------------
    # Vulnerability scanners / pentest tools
    # ------------------------------------
    "~*Nmap Scripting Engine"      1;
    "~*sqlmap"                     1;
    "~*ZmEu"                       1;
    "~*Nikto"                      1;
    "~*acunetix"                   1;
    "~*wpscan"                     1;
    "~*masscan"                    1;
    "~*DirBuster"                  1;
    "~*DirB"                       1;
    "~*Dirsearch"                  1;
    "~*w3af.org"                   1;
    "~*Grabber"                    1;

    # ------------------------------------
    # Headless browsers / automation
    # ------------------------------------
    "~*HeadlessChrome"             1;
    "~*PhantomJS"                  1;
    "~*SlimerJS"                   1;
    "~*Puppeteer"                  1;
    "~*CasperJS"                   1;
    "~*Selenium"                   1;
    "~*WebDriver"                  1;
    "~*crawling at home"           1;

    # ------------------------------------
    # Spammy / shady bots & misc
    # ------------------------------------
    "~*MJ12bot"                    1;
    "~*SemrushBot"                 1;
    "~*AhrefsBot"                  1;
    "~*crawler4j"                  1;
    "~*Scrapy"                     1;
    "~*Apache-HttpClient"          1;
    "~*FeedlyBot"                  1;
    "~*LinkdexBot"                 1;
    "~*PaperLiBot"                 1;
    "~*Screaming Frog"             1;
    "~*ScreamingFrog"              1;
    "~*VelenPublicWebCrawler"      1;
    "~*rogerbot"                   1;
    "~*DotBot"                     1;
    "~*SiteCheck"                  1;
    "~*SEMrush"                    1;

    # ------------------------------------
    # Generic suspicious patterns
    # (CAREFUL with "~*bot" – can hit legit ones)
    # ------------------------------------
    "~*crawler"                    1;
    "~*spider"                     1;
    "~*scraper"                    1;
    "~*site checker"               1;
    "~*site-monitoring"            1;
    "~*check_http"                 1;
    "~*SEO"                        1;

    # If you want ultra-aggressive mode, uncomment this:
    "~*bot"                       1;
}


#############################
# Block empty User-Agent
#############################

# Many bad bots send no User-Agent at all.
# You can use this with:  if ($block_empty_ua) { return 403; }

map $http_user_agent $block_empty_ua {
    default 0;
    "" 1;
}
